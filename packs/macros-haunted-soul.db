{"_id":"t02N8BGuZCCpmV1U","name":"Character creation","type":"script","author":"pdXclp2r5tiEF79G","img":"icons/svg/dice-target.svg","scope":"global","command":"const pirateFactory = game.pirateborg.pirateFactory;\n\nconst validBaseClasses = selectedClasses.filter((selectedClass) => !selectedClass.data.data.requireBaseClass);\nconst baseClass = validBaseClasses[Math.floor(Math.random() * validBaseClasses.length)];\nconst basePirateData = await pirateFactory.rollScvmForClass(baseClass);\n\nconst startingRollItems = await pirateFactory.rollRollItems(selectedClass.data.data.startingRolls);\nconst startingItems = await pirateFactory.findItems(selectedClass.data.data.startingItems);\n\nbasePirateData.items = basePirateData.items\n   .filter((item) => item.data.type !== 'class')\n   .concat(startingRollItems)\n   .concat(startingItems)\n   .concat([selectedClass]);\n\nbasePirateData.baseClass = `${baseClass.pack};${baseClass.name}`\nconsole.log(baseClass );\n\nif (actor) {\n   await pirateFactory.updateActorWithScvm(actor, basePirateData);\n} else {\n   await pirateFactory.createActorWithScvm(basePirateData);\n}","folder":null,"sort":0,"permission":{"default":0,"pdXclp2r5tiEF79G":3},"flags":{"core":{"sourceId":"Macro.smnrajcovGMRvDVa"}}}
{"_id":"t02N8BGuZCCpmV1U","name":"Character creation","type":"script","author":"pdXclp2r5tiEF79G","img":"icons/svg/dice-target.svg","scope":"global","command":"const pirateFactory = game.pirateborg.pirateFactory;\n\nconst validBaseClasses = selectedClasses.filter((selectedClass) => !selectedClass.data.data.requireBaseClass);\nconst baseClass = validBaseClasses[Math.floor(Math.random() * validBaseClasses.length)];\nconst basePirateData = await pirateFactory.rollScvmForClass(baseClass);\n\nconst startingRollItems = await pirateFactory.rollRollItems(selectedClass.data.data.startingRolls);\nconst startingItems = await pirateFactory.findItems(selectedClass.data.data.startingItems);\n\nbasePirateData.items = basePirateData.items\n   .filter((item) => item.data.type !== 'class')\n   .concat(startingRollItems)\n   .concat(startingItems)\n   .concat([selectedClass]);\n\nbasePirateData.baseClass = `${baseClass.pack};${baseClass.name}`\n\nif (actor) {\n   await pirateFactory.updateActorWithScvm(actor, basePirateData);\n} else {\n   await pirateFactory.createActorWithScvm(basePirateData);\n}","folder":null,"sort":0,"permission":{"default":0,"pdXclp2r5tiEF79G":3},"flags":{"core":{"sourceId":"Macro.smnrajcovGMRvDVa"}}}
